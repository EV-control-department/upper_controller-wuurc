# ROV 推力状态可视化功能使用指南

## 功能概述

ROV 推力状态可视化功能是 ROV 控制系统的一个新增特性，它可以根据 X、Y、Z 和 Yaw 轴的输入值，实时显示各个电机的推力方向和大小。这个功能对于调试和理解
ROV 的运动控制非常有帮助。

## 使用方法

1. 启动 `thrust_curve_debugger.py` 工具
2. 在界面右侧可以看到 "电机推力状态示意图" 面板，它显示了 ROV 的简化 3D 模型和各个电机的位置
3. 使用 "直接运动控制" 面板中的滑块或输入框调整 X、Y、Z 和 Yaw 轴的值
4. 推力状态示意图会实时更新，显示每个电机的推力方向和大小
5. 红色箭头表示正向推力，蓝色箭头表示负向推力
6. 箭头的长度表示推力的相对大小

## 电机布局说明

推力状态示意图中的电机布局呈菱形分布，如下：

- **m0**: 右前方水平电机 (45度角)
- **m1**: 右后方水平电机 (45度角)
- **m2**: 左后方水平电机 (45度角)
- **m3**: 左前方水平电机 (45度角)
- **m4**: 前方垂直电机
- **m5**: 后方垂直电机

四个水平电机形成一个菱形/钻石形状，这种布局能更有效地控制ROV的运动。

## 推力分配逻辑

推力状态示意图使用了适合菱形布局的推力分配模型，具体如下：

- **X 轴**（左右）:
    - 正值使右侧电机（m0、m1）产生向右的推力分量
    - 负值使左侧电机（m2、m3）产生向左的推力分量
- **Y 轴**（前后）:
    - 正值使前方电机（m0、m3）产生向前的推力分量
    - 负值使后方电机（m1、m2）产生向后的推力分量
- **Z 轴**（上下）:
    - 正值使垂直电机（m4、m5）产生向上的推力
- **Yaw 轴**（旋转）:
    - 正值使 m0 和 m3 产生正向推力，m1 和 m2 产生负向推力，形成顺时针旋转力矩
    - 负值产生逆时针旋转力矩

由于电机呈菱形布局，每个水平电机的推力都同时具有X和Y方向的分量，这使得ROV能够更灵活地进行复合运动。

## 注意事项

1. 推力状态示意图是基于简化模型，实际 ROV 的推力分配可能更复杂
2. 箭头长度表示相对推力大小，不代表实际物理单位
3. 当推力值较小时（接近零），箭头可能不会显示
4. 可以通过调整视角（拖动鼠标）来从不同角度查看 ROV 模型

## 技术实现

推力状态可视化功能使用 Matplotlib 的 3D 绘图功能实现，主要组件包括：

- `ThrustVisualization` 类：负责创建和更新 3D 可视化
- `update_thrust` 方法：根据输入的 X、Y、Z、Yaw 值更新推力箭头
- `calculate_motor_thrusts` 方法：计算每个电机的推力值

如需修改或扩展此功能，可以编辑 `thrust_curve_debugger.py` 文件中的相关代码。